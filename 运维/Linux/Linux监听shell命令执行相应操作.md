#### 概述

当我们在使用linux操作系统时，经常会碰见在执行某个命令前，需要执行一些前置命令，或者执行某个命令前必须要进入某个目录下。

对于这样的需求，我们可以通过环境变量脚本监听命令，以此来实现某些操作的自动化和便利性。

#### 需求描述

有一个python3.8的django3项目，项目部署时用的是python的虚拟环境，有时候我们需要调试项目代码或执行命令，需要进入虚拟环境中，
但是由于这种场景出现的频率很高，因此我们经常需要执行很长的这样一串命令，所以我希望，在进入项目的部署根目录时，可以自动进入虚拟环境中。

#### 需求分析

上述需求就是一个很常见的场景，我们可以通过监听cd命令，判断用户是否进入了项目根目录，来确定是否进入该项目对应的虚拟环境。

#### 需求实现

编辑用户的环境变量配置文件，添加如下代码

vim ~/.bashrc
```shell
# 监听cd命令，进入指定目录后执行相关环境变量加载
projectDir="/mnt/project/gaia"
projectVenv="/mnt/venv/gaia/bin/activate"

function cd() {
    builtin cd $1

    if [ "$projectDir" == $(pwd) ];then
        source $projectVenv
    fi
}
```

保存代码后，刷新环境变量
```shell
source ~/.bashrc
```

#### 验证

准备好之后，我们就可以进入目录验证了
```shell
cd /mnt/project/gaia
```

可以发现进入目录后就自动执行了进入虚拟环境的操作，非常的实用

#### 延伸知识

##### 关于.bashrc

.bashrc文件主要保存个人的一些个性化设置，如命令别名、路径等。

在每一个用户的家目录下，都会存在这么一个文件。

需要注意的是，如果你的登陆shell不是bash，那么相应的，这个文件也不叫bashrc。比如你的登陆shell是zsh，那么对应的就是zshrc。

它是一个隐藏文件，需要使用```ls -a ~```来查看。

##### 关于builtin

builtin命令用于执行指定的shell内部命令，并返回内部命令的返回值。上述需求中描述的场景就是一个需要用到builtin的例子。

在shell命令执行的优先级中，函数的优先级很高，例如上述例子中，我们在用户自己的环境变量里定义了一个cd函数，当该用户执行cd命令时，
就会优先调用这个自定义的cd命令，而我们定义cd函数的目的并非是想覆盖内置的cd命令的行为，因此我们还需要内置cd命令的功能，
此时如果直接在cd函数中使用cd命令，那么调用的就是cd函数自身。

因此需要使用builtin来显示调用内置cd命令。